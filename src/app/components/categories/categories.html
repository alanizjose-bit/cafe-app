<div class="container">
  <h1>Gestión de Categorías</h1>

  <div class="add-section">
    <h2>Agregar Nueva Categoría</h2>

    <div class="form-group">
      <input
        type="text"
        [ngModel]="newCategoryName()"
        (ngModelChange)="newCategoryName.set($event)"
        placeholder="Nombre de la categoría"
        (keyup.enter)="addCategory()"
        [disabled]="isLoading()"
      />

      <button (click)="addCategory()" [disabled]="isLoading() || !newCategoryName().trim()">
        {{ isLoading() ? 'Guardando...' : 'Agregar' }}
      </button>
    </div>
  </div>

  <div class="list-section">
    <h2>Lista de Categorías ({{ categories().length }})</h2>

    @if (categories().length === 0) {
    <div class="empty-message">No hay categorías registradas</div>
    } @if (categories().length > 0) {
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        @for (category of categories(); track category.id) {
        <tr>
          <td>{{ category.id }}</td>

          <td>
            @if (editingCategory()?.id === category.id) {
            <!-- Modo edición -->
            <input
              type="text"
              [ngModel]="editingName()"
              (ngModelChange)="editingName.set($event)"
              (keyup.enter)="updateCategory()"
            />
            } @else {
            {{ category.name }}
            }
          </td>

          <td>
            @if (editingCategory()?.id === category.id) {
            <div class="action-buttons">
              <button class="btn-save" (click)="updateCategory()" [disabled]="isLoading()">
                Guardar
              </button>

              <button class="btn-cancel" (click)="cancelEdit()" [disabled]="isLoading()">
                Cancelar
              </button>
            </div>
            } @else {
            <div class="action-buttons">
              <button class="btn-edit" (click)="startEdit(category)" [disabled]="isLoading()">
                Editar
              </button>

              <button
                class="btn-delete"
                (click)="deleteCategory(category.id)"
                [disabled]="isLoading()"
              >
                Eliminar
              </button>
            </div>
            }
          </td>
        </tr>
        }
      </tbody>
    </table>
    }
  </div>
</div>
